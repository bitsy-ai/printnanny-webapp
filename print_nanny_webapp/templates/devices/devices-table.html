{% load humanize %}
<div class="row">
    <div class="col-12 d-flex align-items-stretch">
      <div class="card col-12">
        <div class="card-body">
          <h2 class="header-title">
            <i class="mdi mdi-printer-3d"></i> My Devices
              <a href="{% url 'devices:create' %}"><button class="btn btn-primary float-right">Register Raspberry Pi</button></a>

          </h2>
            {% if devices.count > 0 %}
            <table class="table table-centered mb-4 mt-4" id="dashboard-raspberry-pis">
              <p>In the table below, click/tap <strong class="text-primary"><i class="mdi mdi-open-in-new"></i> highlighted links</strong> or 
                <span class="badge badge-primary"> <i class="mdi mdi-information"></i></span> to see more information.</p>
              <thead>
                  <tr>
                      <th>Hostname</th>
                      <!-- <th>Monitoring Active</th> -->
                      <th>Task Status</th>
                      <!-- <th>Job Status</th> -->
        
                      <!-- <th>File</th>
                      <th>Progress</th> -->
                      <th>Livestream</th>
                  </tr>
              </thead>
              <tbody>
  
                {% for device in devices %}
                <tr>
                    <td><h4><a href="{% url 'devices:detail' pk=device.id %}"><i class="mdi mdi-open-in-new"></i> {{device.hostname}}</a></h4></td>
                    <!-- <td>
                        <div class="progress progress-sm">
                            <div class="progress-bar progress-lg bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </td> -->
                    <!-- <td><i class="mdi mdi-circle {{device.monitoring_active_css_class}}"></i> {{device.monitoring_active}}</td> -->
                <td>
                      <a 
                      data-toggle="popover" 
                      data-placement="right" 
                      title="Task: {{ device.last_task.get_task_type_display }}" 
                      {% if task.last_status.wiki_url %}
                      data-content="{{ device.last_task.last_status.msg }} <br><a target='_blank' href='{{ device.last_task.last_status.wiki_url}'>Get more info</a>"
                      {% else %} 
                      data-content="{{ device.last_task.last_status.get_status_display }}" 
                      {% endif %}
                      data-html="true"
                      class="badge badge-{{ device.last_task.last_status.css_class }}"
                      >
                      <i class="mdi mdi-information"></i>
                      {{ device.last_task.get_task_type_display }}:
                      {{ device.last_task.last_status.status | capfirst }}
  
                      </a>
                </td>
                <td>
                    <a href="{% url 'devices:license' pk=device.id %}" target="_blank"><button class="btn btn-primary">View Livestream</button></a>
                </td>
                </tr>
              {% endfor %}
  
              </tbody>
          </table>
  
          {% else %}
          <p>No Print Nanny devices detected. Click the <strong>Register Raspberry Pi</strong> button to get started.

          {% endif %}
        </div>
        <div class="card-footer">
          <p>Please reach out to <a href="mailto:leigh@print-nanny.com">leigh@print-nanny.com</a> if you run into any issues.</p>
          
          <p><span class="badge badge-danger">FYI</span> Raspberry Pi 3 and Pi Zero models are <strong>not supported</strong> at this time! Please check the <a href="{{ HELP_PRINTNANNY_COMPATIBLE }}" target="_blank">capatible devices</a> list to see if your Raspberry Pi is supported.</p>

        </div>
      </div>
    </div>
  
  </div>
  