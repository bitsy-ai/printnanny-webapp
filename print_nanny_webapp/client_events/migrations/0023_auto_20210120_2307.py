# Generated by Django 3.1.3 on 2021-01-21 07:07

from __future__ import unicode_literals
import json
from django.db import migrations
from print_nanny_webapp.client_events.models import PrintJobEvent


class Migration(migrations.Migration):
    def forward_data_migration(apps, schema):
        for event in PrintJobEvent.objects.all():
            try:
                event.temp_state = json.loads(event.state)
                event.save()
            except json.decoder.JSONDecodeError as e:
                print("Cannot convert {} object".format(event.pk))

    def revert_migration(apps, schema):
        pass

    dependencies = [
        ("client_events", "0022_printjobevent_temp_state"),
    ]

    operations = [
        migrations.RunPython(code=forward_data_migration, reverse_code=revert_migration)
    ]
